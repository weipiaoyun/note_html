<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>

<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="Stylesheet" type="text/css" href="styles/style.css">
<link rel="stylesheet" type="text/css" href="styles/codeStyles/shCore.css">
<link rel="stylesheet" type="text/css" href="styles/codeStyles/shThemeDefault.css">

<title>菲林还原</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

<p>
  /****** Script for SelectTopNRows command from SSMS  ******/<br />
SELECT * into #tmpTab<br />
  FROM [ZH_DB].[dbo].[T_WF_FilmOrderDetialInfo_bak] where insertDate = '2018-01-16 08:15:01'<br />
</p>
 
<p>
	declare <br />
	@Guid_ varchar(50),<br />
	@group_ varchar(50), <br />
</p>
<blockquote>
@TiaoMa_ varchar(50),
@ApplyGuid_ varchar(50),
@jobName_ varchar(50),
@Apply2Dep varchar(50),
@Aplly2People varchar(50),
@TheFilmReson varchar(50),
@ScaleX_ varchar(50),
@ScaleY_ varchar(50),
@ApplyNum_ varchar(50),
@FinishX_ varchar(50),
@FinishY_ varchar(50),
@TieMoX_ varchar(50),
@TieMoY_ varchar(50),
@FilmType_ varchar(50),
@FilmLayer_ varchar(50),
@LayerIndex_ varchar(50),
@Machine_ varchar(50),
@FilmId_ varchar(50),
@ApplyTime varchar(50),
@OrderOfFilm_ varchar(50),
@CancelFilm_ varchar(50),
@WIP_ varchar(50),
@Film_ varchar(50),
@FilmTime_ varchar(50),
@Check_ varchar(50),
@CheckTime_ varchar(50),
@Mir_ varchar(50),
@Polarity_ varchar(50),
@Size_ varchar(50),
@Priority_ varchar(50),
@FilmNumApply_ varchar(50),
@FilmNumIng_ varchar(50),
@FilmNumOk_ varchar(50),
@Storage_ varchar(50),
@StorageTime_ varchar(50),
@SendName_ varchar(50),
@SendTime_ varchar(50),
@SendNum_ varchar(50),
@ReceiveName_ varchar(50),
@GivebackTime_ varchar(50),
@GivebackNum_ varchar(50),
@ConfirmName_ varchar(50),
@ReceiveWaiting_ varchar(50),
@CloseName_ varchar(50),
@CloseTime_ varchar(50),
@CloseStatus_ varchar(50),
@IsBrushoff_ varchar(50),
@BrushoffName_ varchar(50),
@BrushoffTime_ varchar(50),
@Week_ varchar(50),
@Remark_ varchar(50),
@selectNum_ varchar(50),
@addIndex_ varchar(50)
</blockquote>
<blockquote>
--select * from #tmpTab
</blockquote>
	
<p>
 while exists (select top 1 Guid_ from #tmpTab)<br />
 begin<br />
	select top 1 <br />
	@group_ =    group_,<br />
@Guid_ = Guid_,<br />
@TiaoMa_ = TiaoMa_,<br />
@ApplyGuid_ = ApplyGuid_,<br />
@jobName_ = jobName_,<br />
@Apply2Dep = Apply2Dep,<br />
@Aplly2People = Aplly2People,<br />
@TheFilmReson = TheFilmReson,<br />
@ScaleX_ = ScaleX_,<br />
@ScaleY_ = ScaleY_,<br />
@ApplyNum_ = ApplyNum_,<br />
@FinishX_ = FinishX_,<br />
@FinishY_ = FinishY_,<br />
@TieMoX_ = TieMoX_,<br />
@TieMoY_ = TieMoY_,<br />
@FilmType_ = FilmType_,<br />
@FilmLayer_ = FilmLayer_,<br />
@LayerIndex_ = LayerIndex_,<br />
@Machine_ = Machine_,<br />
@FilmId_ = FilmId_,<br />
@ApplyTime = ApplyTime,<br />
@OrderOfFilm_ = OrderOfFilm_,<br />
@CancelFilm_ = CancelFilm_,<br />
@WIP_ = WIP_,<br />
@Film_ = Film_,<br />
@FilmTime_ = FilmTime_,<br />
@Check_ = Check_,<br />
@CheckTime_ = CheckTime_,<br />
@Mir_ = Mir_,<br />
@Polarity_ = Polarity_,<br />
@Size_ = Size_,<br />
@Priority_ = Priority_,<br />
@FilmNumApply_ = FilmNumApply_,<br />
@FilmNumIng_ = FilmNumIng_,<br />
@FilmNumOk_ = FilmNumOk_,<br />
@Storage_ = Storage_,<br />
@StorageTime_ = StorageTime_,<br />
@SendName_ = SendName_,<br />
@SendTime_ = SendTime_,<br />
@SendNum_ = SendNum_,<br />
@ReceiveName_ = ReceiveName_,<br />
@GivebackTime_ = GivebackTime_,<br />
@GivebackNum_ = GivebackNum_,<br />
@ConfirmName_ = ConfirmName_,<br />
@ReceiveWaiting_ = ReceiveWaiting_,<br />
@CloseName_ = CloseName_,<br />
@CloseTime_ = CloseTime_,<br />
@CloseStatus_ = CloseStatus_,<br />
@IsBrushoff_ = IsBrushoff_,<br />
@BrushoffName_ = BrushoffName_,<br />
@BrushoffTime_ = BrushoffTime_,<br />
@Week_ = Week_,<br />
@Remark_ = Remark_,<br />
@selectNum_ = selectNum_,<br />
@addIndex_ = addIndex_<br />
</p>

<p>
	 from #tmpTab<br />
</p>
	
<p>
	--如果存在，则更新<br />
</p>
	
<p>
	--if exists (select top 1 Guid_ from [ENGSYS4DG].[EngSys].[dbo].[T_WF_FilmOrderDetialInfo])<br />
	if exists (select top 1 Guid_ from [ZH_DB].[dbo].[T_WF_FilmOrderDetialInfo] where Guid_ = @Guid_)<br />
	begin<br />
		--update [ENGSYS4DG].[EngSys].[dbo].[T_WF_FilmOrderDetialInfo] set TieMoX_ = '10', TieMoY_ = '20'  where Guid_ = @Guid <br />
</p>
<blockquote>
print ''
</blockquote>
<blockquote>
update [ZH_DB].[dbo].[T_WF_FilmOrderDetialInfo] set
group_ = @group_,
</blockquote>
<p>
		Guid_ = @Guid_,<br />
		ApplyGuid_ = @ApplyGuid_,<br />
		jobName_ = @jobName_,<br />
		Apply2Dep = @Apply2Dep,<br />
		Aplly2People = @Aplly2People,<br />
		TheFilmReson = @TheFilmReson,<br />
		ScaleX_ = @ScaleX_,<br />
		ScaleY_ = @ScaleY_,<br />
		ApplyNum_ = @ApplyNum_,<br />
		FinishX_ = @FinishX_,<br />
		FinishY_ = @FinishY_,<br />
		TieMoX_ = @TieMoX_,<br />
		TieMoY_ = @TieMoY_,<br />
		FilmType_ = @FilmType_,<br />
		FilmLayer_ = @FilmLayer_,<br />
		LayerIndex_ = @LayerIndex_,<br />
		Machine_ = @Machine_,<br />
		FilmId_ = @FilmId_,<br />
		ApplyTime = @ApplyTime,<br />
		OrderOfFilm_ = @OrderOfFilm_,<br />
		CancelFilm_ = @CancelFilm_,<br />
		WIP_ = @WIP_,<br />
		Film_ = @Film_,<br />
		FilmTime_ = @FilmTime_,<br />
		Check_ = @Check_,<br />
		CheckTime_ = @CheckTime_,<br />
		Mir_ = @Mir_,<br />
		Polarity_ = @Polarity_,<br />
		Size_ = @Size_,<br />
		Priority_ = @Priority_,<br />
		FilmNumApply_ = @FilmNumApply_,<br />
		FilmNumIng_ = @FilmNumIng_,<br />
		FilmNumOk_ = @FilmNumOk_,<br />
		Storage_ = @Storage_,<br />
		StorageTime_ = @StorageTime_,<br />
		SendName_ = @SendName_,<br />
		SendTime_ = @SendTime_,<br />
		SendNum_ = @SendNum_,<br />
		ReceiveName_ = @ReceiveName_,<br />
		GivebackTime_ = @GivebackTime_,<br />
		GivebackNum_ = @GivebackNum_,<br />
		ConfirmName_ = @ConfirmName_,<br />
		ReceiveWaiting_ = @ReceiveWaiting_,<br />
		CloseName_ = @CloseName_,<br />
		CloseTime_ = @CloseTime_,<br />
		BrushoffName_ = @BrushoffName_,<br />
		BrushoffTime_ = @BrushoffTime_,<br />
		Week_ = @Week_,<br />
		Remark_ = @Remark_,<br />
		selectNum_ = @selectNum_,<br />
		addIndex_ = @addIndex_<br />
</p>
<blockquote>
where Guid_ = @Guid_
</blockquote>
<p>
	end<br />
</p>
	
<p>
	else<br />
	begin<br />
</p>

<p>
		INSERT INTO [ZH_DB].[dbo].[T_WF_FilmOrderDetialInfo] <br />
		(<br />
</p>
<blockquote>
group_,
Guid_,
ApplyGuid_,
jobName_,
Apply2Dep,
Aplly2People,
TheFilmReson,
ScaleX_,
ScaleY_,
ApplyNum_,
FinishX_,
FinishY_,
TieMoX_,
TieMoY_,
FilmType_,
FilmLayer_,
LayerIndex_,
Machine_,
FilmId_,
ApplyTime,
OrderOfFilm_,
CancelFilm_,
WIP_,
Film_,
FilmTime_,
Check_,
CheckTime_,
Mir_,
Polarity_,
Size_,
Priority_,
FilmNumApply_,
FilmNumIng_,
FilmNumOk_,
Storage_,
StorageTime_,
SendName_,
SendTime_,
SendNum_,
ReceiveName_,
GivebackTime_,
GivebackNum_,
ConfirmName_,
ReceiveWaiting_,
CloseName_,
CloseTime_,
BrushoffName_,
BrushoffTime_,
Week_,
Remark_,
selectNum_,
addIndex_
</blockquote>
<p>
		)<br />
		VALUES (<br />
		@group_,<br />
</p>
<blockquote>
@Guid_,
@ApplyGuid_,
@jobName_,
@Apply2Dep,
@Aplly2People,
@TheFilmReson,
@ScaleX_,
@ScaleY_,
@ApplyNum_,
@FinishX_,
@FinishY_,
@TieMoX_,
@TieMoY_,
@FilmType_,
@FilmLayer_,
@LayerIndex_,
@Machine_,
@FilmId_,
@ApplyTime,
@OrderOfFilm_,
@CancelFilm_,
@WIP_,
@Film_,
@FilmTime_,
@Check_,
@CheckTime_,
@Mir_,
@Polarity_,
@Size_,
@Priority_,
@FilmNumApply_,
@FilmNumIng_,
@FilmNumOk_,
@Storage_,
@StorageTime_,
@SendName_,
@SendTime_,
@SendNum_,
@ReceiveName_,
@GivebackTime_,
@GivebackNum_,
@ConfirmName_,
@ReceiveWaiting_,
@CloseName_,
@CloseTime_,
@BrushoffName_,
@BrushoffTime_,
@Week_,
@Remark_,
@selectNum_,
@addIndex_
) 
</blockquote>
<p>
	end<br />
</p>
	
<p>
	delete #tmpTab where Guid_  = @Guid_<br />
 end<br />
 drop table   #tmpTab<br />
</p>
  
<p>
  return<br />
</p>
  
<p>
  	INSERT INTO [ZH_DB].[dbo].[T_WF_FilmOrderDetialInfo] <br />
		(Guid_,jobName_ ,ScaleX_,ScaleY_,[FilmType_],[Machine_],[TheFilmReson],[Apply2Dep],[Aplly2People],[ApplyTime],Priority_,FilmLayer_,[FinishX_],[FinishY_],group_,Remark_)<br />
		VALUES (<br />
		'5129BB7D-5E5E-42C3-B4A6-7E28840AC53E', <br />
		'bk23303a0' ,<br />
		'100.010' ,<br />
		'100.010',<br />
		'防焊', <br />
		'防焊自动-新',<br />
		'更改周期',<br />
		'',<br />
		'',<br />
		GETDATE(),<br />
		'',<br />
		'',<br />
		'',<br />
		'',<br />
		'', <br />
		'')<br />
</p>


<div class="foot">
<button id="back_to_topA" class="back_to_top" style='background-color:red'>返回顶部</button>

<a id="returnIndexA" href="d:\vim\vim\mysite\note_html\笔记整理.html" onclick="fun_a()">
<button id=returnIndex class="back_to_index">返回首页</button>
</a>



<HR SIZE=5>
<p class="left">
<!-- <div class="text" style=" text-align:center;font-size:15px"></div>-->
© <span id="year">2018</span> 
</p>
<script src="scripts/my.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/XRegExp.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shCore.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shBrushJava.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shBrushJScript.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shBrushSql.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shBrushCSharp.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shBrushCss.js"></script>
<script type="text/javascript" src="scripts/codeStyleScript/shBrushPerl.js"></script>
<script type="text/javascript">
	SyntaxHighlighter.all()
</script>
</div>
</div>
</body>
</html>
