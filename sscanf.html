<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>sscanf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

<p>
作用：利用它可以从字符串中取出整数、浮点数和字符串等等
sscanf(a, b, c);把a的数据转换成b的格式放到c里面
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
</p>


<p>
int main(int argc, const char *argv[])
{
</p>
	
<p>
	char str[512] = {0};
	sscanf("123456abcdedf","%[^ ]",str);
	printf("str=%s",str);
</p>


<p>
}
</p>

<p>
str=123456abcdedfPress any key to continue
</p>

<h1 id="toc_1">问题</h1>
<p>
sscanf,表示从字符串中格式化输入
</p>

<p>
上面表示从str中，输入数字给x，就是32700
久以前，我以为c没有自己的split string函数，后来我发现了sscanf；一直以来，我以为sscanf只能以空格来界定字符串，现在我发现我错了。
</p>
 
<p>
sscanf是一个运行时函数，原形很简单：
int sscanf(
const char *buffer,
   const char *format [,
   argument ] ... 
);
它强大的功能体现在对format的支持上。
</p>
 
<p>
我以前用它来分隔类似这样的字符串2006:03:18:
int a, b, c;
sscanf("2006:03:18", "%d:%d:%d", a, b, c);
以及2006:03:18 - 2006:04:18:
char sztime1[16] = "", sztime2[16] = "";
sscanf("2006:03:18 - 2006:04:18", "%s - %s", sztime1, sztime2);
</p>
 
<p>
但是后来，我需要处理2006:03:18-2006:04:18
仅仅是取消了‘-’两边的空格，却打破了%s对字符串的界定。
</p>
 
<p>
我需要重新设计一个函数来处理这样的情况？这并不复杂，但是，为了使所有的代码都有统一的风格，我需要改动很多地方，把已有的sscanf替换成我自己的分割函数。我以为我肯定需要这样做，并伴随着对sscanf的强烈不满而入睡；一觉醒来，发现其实不必。
</p>
 
<p>
format-type中有%[]这样的type field。如果读取的字符串，不是以空格来分隔的话，就可以使用%[]。
%[]类似于一个正则表达式。[a-z]表示读取a-z的所有字符，[^a-z]表示读取除a-z以外的所有字符。
</p>
 
<p>
所以那个问题也就迎刃而解了:
sscanf("2006:03:18 - 2006:04:18", "%[0-9,:] - %[0-9,:]", sztime1, sztime2);
在softmse (Jake) 的问题贴<a href="http://community.csdn.net/Expert/topic/4843/4843294.xml?temp=.4321558中">http://community.csdn.net/Expert/topic/4843/4843294.xml?temp=.4321558中</a><br> ，周星星给出了一个很cool的sscanf用例，而后通过学习，发现sscanf真棒，现做一总结。
</p>

<p>
原问题：
</p>

<p>
iios/12DDWDFF@122
获取/和@之间的字符串怎么做
C程序里面有什么函数吗?
</p>

<p>
周星星的代码：
</p>

<p>
#include &lt;stdio.h&gt;
</p>

<p>
int main()
{
</p>
<blockquote>
const char* s = "iios/12DDWDFF@122";
char buf[20];
</blockquote>
<blockquote>
sscanf( s, "%*[<sup><small>/]/%[</small></sup>@]", buf );
printf( "%s\n", buf );
</blockquote>
<blockquote>
return 0;
</blockquote>
<p>
}
</p>

<p>
结果为:12DDWDFF
</p>

<p>
sscanf与scanf类似，都是用于输入的，只是后者以屏幕(stdin)为输入源，前者以固定字符串为输入源。
</p>

<p>
函数原型：
</p>

<p>
int scanf( const char *format [,argument]... );
其中的format可以是一个或多个 {%[*] [width] [{h | l | I64 | L}]type  |  ' ' |  '\t' | '\n' | 非%符号}，
</p>

<p>
注：{a|b|c}表示a,b,c中选一，[d],表示可以有d也可以没有d。
</p>

 

<p>
 width:宽度，一般可以忽略，用法如：
</p>

<p>
const  char sourceStr[] = "hello, world";
</p>

<p>
char buf[10] = {0};
</p>

<p>
sscanf(sourceStr, "%5s", buf);   //%5s，只取5个字符
</p>

<p>
cout &lt;&lt; buf&lt;&lt; endl;
</p>

<p>
结果为:hello
</p>

<p>
 {h | l | I64 | L}:参数的size,通常h表示单字节size，I表示2字节 size,L表示4字节size(double例外),l64表示8字节size。
</p>

<p>
type :这就很多了，就是%s,%d之类。
</p>

 

<p>
特别的：
</p>

<p>
%*[width] [{h | l | I64 | L}]type  表示满足该条件的被过滤掉，不会向目标参数中写入值。如：
</p>

<p>
const  char sourceStr[] = "hello, world";
</p>

<p>
char buf[10] = {0};
</p>

<p>
sscanf(sourceStr, "%*s%s", buf);   //%*s表示第一个匹配到的%s被过滤掉，即hello被过滤了
</p>

<p>
cout &lt;&lt; buf&lt;&lt; endl;
</p>

<p>
结果为:world
</p>

<p>
支持集合操作：
</p>
<blockquote>
%[a-z]  表示匹配a到z中任意字符，贪婪性(尽可能多的匹配)
</blockquote>
<blockquote>
%[aB']  匹配a、B、'中一员，贪婪性
</blockquote>
<blockquote>
%[^a]    匹配非a的任意字符，贪婪性
</blockquote>
<blockquote>
是不是感觉眼熟了啊，不错，这和正则表达式很相似，而且仍然支持过滤，即可以有%*[a-z].如：
</blockquote>

<p>
星星大哥例子回顾：
</p>
<blockquote>
const char* s = "iios/12DDWDFF@122";
char buf[20];
</blockquote>
<blockquote>
sscanf( s, "%*[<sup><small>/]/%[</small></sup>@]", buf );
printf( "%s\n", buf );
</blockquote>

<p>
先将 "iios/"过滤掉，再将非'@'的一串内容送到buf中，cool.得到结果。
</p>

<p>
PS: 向星星大哥和softmse (Jake) 致谢了，有了你们才有它啊
</p>

<button class="back_to_top" style='background-color:red'>返回顶部</button>

<a href="https://weipiaoyun.github.io/note_html/我的主页.html">
<button class="back_to_index" style='background-color:red'>返回首页</button>
</a>

<script src="my.js"></script>
<HR SIZE=5>
<p class="left">
<!-- <div class="text" style=" text-align:center;font-size:15px"></div>-->
© <span id="year">2018</span> 
</p>
</body>
</body>
</html>
